<!-- templates/sig/view_all_properties.html -->
<!DOCTYPE html>
<html>
<head>
    <title>View All Geographical Properties</title>
    <!-- Agregar las referencias a los archivos de Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <!-- Agregar las referencias a los archivos de Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <style>
        /* Agregar un estilo para el contenedor del mapa */
        #map {
            height: 400px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1>All Geographical Properties</h1>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
              
                    <th>Point</th>
                    <th>Postal Code</th>
                </tr>
            </thead>
            <tbody>
                {% for property in properties %}
                <tr>
                    <td>{{ property.name }}</td>
                    <td>{{ property.point }}</td>
                    <td>{{ property.postal_code }}</td>
                </tr>
                {% endfor %}

                {% for nombre in nombres %}
                <tr>
                    <td>{{ nombre }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Agregar un div para el mapa -->
    <div id="map"></div>

    <!-- Script para crear el mapa y los marcadores -->
    <script>
        // Inicializar el mapa en el div con el ID 'map'
        var mymap = L.map('map').setView([19.27233554797819, -99.4504596715741], 15);
    
        // Agregar una capa de mapa base de OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mymap);
        // Variables para el punto
        var name = "Nombre del punto";
        var latitude = 19.27233554797819;
        var longitude = -99.4504596715741;

        // Agregar un marcador en las coordenadas
        L.marker([latitude, longitude]).addTo(mymap).bindPopup(name + "<br>Latitud: " + latitude + "<br>Longitud: " + longitude);
        // Variables para los marcadores
        {% if properties|length %}
            {% for property in properties %}
                var name = "{{ property.name }}";
                var latitude = "{{ property.point.y|default:'' }}";
                var longitude = "{{ property.point.x|default:'' }}";
    
                // Verificar si latitude y longitude tienen valores válidos antes de agregar el marcador
                if (latitude && longitude) {
                    // Convertir las coordenadas a números
                    latitude = parseFloat(latitude);
                    longitude = parseFloat(longitude);
    
                    // Agregar un marcador en las coordenadas
                    L.marker([latitude, longitude]).addTo(mymap)
                        .bindPopup(name + "<br>Latitud: " + latitude + "<br>Longitud: " + longitude);
                }
            {% endfor %}
        {% endif %}
    </script>
    
</body>
</html>

